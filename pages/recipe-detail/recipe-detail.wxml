<!--èœè°±è¯¦æƒ…é¡µ-->
<view class="container" wx:if="{{!loading && recipe}}">
    <!-- å°é¢å›¾ -->
    <view class="cover-section">
        <image class="cover-image" src="{{recipe.cover_image_key || '/assets/images/default-recipe.png'}}" mode="aspectFill" />
    </view>

    <!-- åŸºæœ¬ä¿¡æ¯ -->
    <view class="info-section">
        <view class="recipe-title">{{recipe.name}}</view>
        <view class="recipe-desc" wx:if="{{recipe.description}}">{{recipe.description}}</view>

        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
        <view class="stats-row">
            <view class="stat-item">
                <text class="icon">ğŸ‘</text>
                <text class="text">{{recipe.view_count}}</text>
            </view>
            <view class="stat-item">
                <text class="icon">ğŸ‘</text>
                <text class="text">{{recipe.like_count}}</text>
            </view>
        </view>

        <!-- æ ‡ç­¾ -->
        <view class="tags-row" wx:if="{{recipe.tags && recipe.tags.length > 0}}">
            <view class="tag" wx:for="{{recipe.tags}}" wx:key="index">{{item}}</view>
        </view>
    </view>

    <!-- æ­¥éª¤å†…å®¹ -->
    <view class="steps-section" wx:if="{{recipe.step_type === 'custom' && recipe.steps}}">
        <view class="section-title">åˆ¶ä½œæ­¥éª¤</view>
        <view class="step-item" wx:for="{{parseSteps(recipe.steps)}}" wx:key="index">
            <view class="step-number">{{index + 1}}</view>
            <view class="step-content">{{item}}</view>
        </view>
    </view>

    <!-- é“¾æ¥å†…å®¹ -->
    <view class="links-section" wx:if="{{recipe.step_type === 'link' && recipe.links}}">
        <view class="section-title">å‚è€ƒé“¾æ¥</view>
        <view class="link-item" wx:for="{{parseLinks(recipe.links)}}" wx:key="index">
            <text class="link-text">{{item}}</text>
        </view>
    </view>

    <!-- åº•éƒ¨æ“ä½œæ  -->
    <view class="action-bar">
        <t-button 
            theme="{{isFavorited ? 'default' : 'primary'}}" 
            size="large" 
            bind:tap="toggleFavorite"
            wx:if="{{!isOwner}}"
        >
            {{isFavorited ? 'å–æ¶ˆæ”¶è—' : 'æ”¶è—'}}
        </t-button>
        
        <view class="owner-actions" wx:if="{{isOwner}}">
            <t-button theme="primary" size="large" bind:tap="editRecipe">
                ç¼–è¾‘èœè°±
            </t-button>
            <t-button theme="danger" size="large" bind:tap="deleteRecipe">
                åˆ é™¤èœè°±
            </t-button>
        </view>
    </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-state" wx:if="{{loading}}">
    <t-loading theme="circular" size="large" text="åŠ è½½ä¸­..." />
</view>
