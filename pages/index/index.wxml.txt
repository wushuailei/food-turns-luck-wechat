<!--é¦–é¡µ - èœè°±åˆ—è¡¨-->
<view class="container">
    <!-- æœç´¢æ  -->
    <view class="search-bar">
        <t-search model:value="{{searchKeyword}}" placeholder="æœç´¢èœè°±" bind:change="onSearchInput" bind:submit="onSearch" />
    </view>

    <!-- æ ‡ç­¾ç­›é€‰ -->
    <view class="tags-container" wx:if="{{tags.length > 0}}">
        <scroll-view class="tags-scroll" scroll-x>
            <view class="tag-item {{selectedTag === '' ? 'active' : ''}}" bindtap="onTagSelect" data-tag="">
                å…¨éƒ¨
            </view>
            <view class="tag-item {{selectedTag === item ? 'active' : ''}}" wx:for="{{tags}}" wx:key="index" bindtap="onTagSelect" data-tag="{{item}}">
                {{item}}
            </view>
        </scroll-view>
    </view>

    <!-- æ’åºæ  -->
    <view class="sort-bar">
        <view class="sort-item {{orderBy === 'created_at' ? 'active' : ''}}" bindtap="onSortChange" data-sort="created_at">
            æœ€æ–°
        </view>
        <view class="sort-item {{orderBy === 'view_count' ? 'active' : ''}}" bindtap="onSortChange" data-sort="view_count">
            æœ€çƒ­
        </view>
        <view class="sort-item {{orderBy === 'like_count' ? 'active' : ''}}" bindtap="onSortChange" data-sort="like_count">
            æœ€èµ
        </view>
    </view>

    <!-- èœè°±åˆ—è¡¨ -->
    <view class="recipe-list">
        <view class="recipe-card" wx:for="{{recipeList}}" wx:key="id" bindtap="goToRecipeDetail" data-id="{{item.id}}">
            <view class="recipe-cover">
                <image class="cover-image" src="{{item.cover_image_key || '/assets/images/default-recipe.png'}}" mode="aspectFill" />
            </view>
            <view class="recipe-info">
                <view class="recipe-name">{{item.name}}</view>
                <view class="recipe-desc">{{item.description || 'æš‚æ— æè¿°'}}</view>
                <view class="recipe-meta">
                    <view class="meta-item">
                        <text class="icon">ğŸ‘</text>
                        <text class="text">{{item.view_count}}</text>
                    </view>
                    <view class="meta-item">
                        <text class="icon">ğŸ‘</text>
                        <text class="text">{{item.like_count}}</text>
                    </view>
                </view>
            </view>
        </view>

        <!-- ç©ºçŠ¶æ€ -->
        <view class="empty-state" wx:if="{{!loading && recipeList.length === 0}}">
            <t-empty description="æš‚æ— èœè°±" />
        </view>

        <!-- åŠ è½½æ›´å¤šæç¤º -->
        <view class="load-more" wx:if="{{recipeList.length > 0}}">
            <text wx:if="{{loading}}">åŠ è½½ä¸­...</text>
            <text wx:elif="{{!hasMore}}">æ²¡æœ‰æ›´å¤šäº†</text>
        </view>
    </view>
</view>
